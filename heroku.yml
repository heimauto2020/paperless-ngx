setup:
  addons:
    - plan: heroku-redis:hobby-dev
      as: REDIS

build:
  docker:
    web: paperless-ngx/Dockerfile
    gotenberg: gotenberg/build/Dockerfile
    tika: tika/full/Dockerfile
  config:
    PAPERLESS_REDIS: ${REDIS_URL}
    PAPERLESS_DBENGINE: postgresql
    PAPERLESS_DBHOST: ${EXTERNAL_DB_HOST}
    PAPERLESS_DBPORT: ${EXTERNAL_DB_PORT}
    PAPERLESS_DBUSER: ${EXTERNAL_DB_USER}
    PAPERLESS_DBPASS: ${EXTERNAL_DB_PASSWORD}
    PAPERLESS_TIKA_ENABLED: "1"
    PAPERLESS_TIKA_GOTENBERG_ENDPOINT: http://gotenberg:3000
    PAPERLESS_TIKA_ENDPOINT: http://tika:9998
    PAPERLESS_CONSUME_DIR: /mnt/gdrive/${USERNAME}/consume
    PAPERLESS_EXPORT_DIR: /mnt/gdrive/${USERNAME}/export
    GOLANG_VERSION: "1.24.3"
run:
  gotenberg: "gotenberg --chromium-disable-javascript=true --chromium-allow-list=file:///tmp/.*"